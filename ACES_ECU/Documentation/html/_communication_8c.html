<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ACES ECU: C:/Users/nickm/Documents/GitHub/ACES_ECU/ACES_ECU/Communication.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ACES ECU
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">Software Implementation of Team ACES ECU</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">C:/Users/nickm/Documents/GitHub/ACES_ECU/ACES_ECU/Communication.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implementation for the functions relating to the communication of the ECU/ESB and ECU/Windows GUI.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;avr/io.h&gt;</code><br />
<code>#include &lt;avr/interrupt.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;<a class="el" href="_e_c_u__funcs_8h_source.html">ECU_funcs.h</a>&quot;</code><br />
</div>
<p><a href="_communication_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9ad78c90a2e828201a614444385801c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_communication_8c.html#a9ad78c90a2e828201a614444385801c7">sendToESB</a> (uint8_t len)</td></tr>
<tr class="memdesc:a9ad78c90a2e828201a614444385801c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmits data between the ECU and ESB.  <a href="#a9ad78c90a2e828201a614444385801c7">More...</a><br /></td></tr>
<tr class="separator:a9ad78c90a2e828201a614444385801c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3590f927d6f0e270aad13cd890ba3d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_communication_8c.html#aa3590f927d6f0e270aad13cd890ba3d5">ESB_Connect</a> (void)</td></tr>
<tr class="memdesc:aa3590f927d6f0e270aad13cd890ba3d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establishes the connection between the ECU and ESB.  <a href="#aa3590f927d6f0e270aad13cd890ba3d5">More...</a><br /></td></tr>
<tr class="separator:aa3590f927d6f0e270aad13cd890ba3d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada467eaa29152bd3a35afbf4d62e53fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_communication_8c.html#ada467eaa29152bd3a35afbf4d62e53fd">GUI_Connect</a> (void)</td></tr>
<tr class="memdesc:ada467eaa29152bd3a35afbf4d62e53fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Establishes the connection between the ECU and Windows GUI.  <a href="#ada467eaa29152bd3a35afbf4d62e53fd">More...</a><br /></td></tr>
<tr class="separator:ada467eaa29152bd3a35afbf4d62e53fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebc6f692b7c3787a859445b96ab3ec5f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_communication_8c.html#aebc6f692b7c3787a859445b96ab3ec5f">sendToLaptop</a> (void)</td></tr>
<tr class="memdesc:aebc6f692b7c3787a859445b96ab3ec5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmits periodic data between the ECU and Windows GUI.  <a href="#aebc6f692b7c3787a859445b96ab3ec5f">More...</a><br /></td></tr>
<tr class="separator:aebc6f692b7c3787a859445b96ab3ec5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a084f0a9cf05b1877bd8a71a90dae7ff8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_communication_8c.html#a084f0a9cf05b1877bd8a71a90dae7ff8">ISR</a> (USART0_RX_vect)</td></tr>
<tr class="memdesc:a084f0a9cf05b1877bd8a71a90dae7ff8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interrupt Service Routine for when a message has been received from the Windows GUI.  <a href="#a084f0a9cf05b1877bd8a71a90dae7ff8">More...</a><br /></td></tr>
<tr class="separator:a084f0a9cf05b1877bd8a71a90dae7ff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6e8a8009a9ae0c59f25a496d1cf5a84"><td class="memItemLeft" align="right" valign="top"><a id="ae6e8a8009a9ae0c59f25a496d1cf5a84"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>ISR</b> (USART1_RX_vect)</td></tr>
<tr class="separator:ae6e8a8009a9ae0c59f25a496d1cf5a84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae173d68280445c6d2838fe28f007ebaf"><td class="memItemLeft" align="right" valign="top"><a id="ae173d68280445c6d2838fe28f007ebaf"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>packageMessage</b> (void)</td></tr>
<tr class="separator:ae173d68280445c6d2838fe28f007ebaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a285a2f8773a070acdcea234b60cf38ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_communication_8c.html#a285a2f8773a070acdcea234b60cf38ca">repeatCommand</a> (void)</td></tr>
<tr class="memdesc:a285a2f8773a070acdcea234b60cf38ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Requests the Windows GUI to repeat the last sent command.  <a href="#a285a2f8773a070acdcea234b60cf38ca">More...</a><br /></td></tr>
<tr class="separator:a285a2f8773a070acdcea234b60cf38ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae11da7e638c4141fa09c2b3748f713fd"><td class="memItemLeft" align="right" valign="top"><a id="ae11da7e638c4141fa09c2b3748f713fd"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>i2c_Start</b> (unsigned char address)</td></tr>
<tr class="separator:ae11da7e638c4141fa09c2b3748f713fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d7492476cf394bef5161e2a6503fc1e"><td class="memItemLeft" align="right" valign="top"><a id="a7d7492476cf394bef5161e2a6503fc1e"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>i2c_Stop</b> (void)</td></tr>
<tr class="separator:a7d7492476cf394bef5161e2a6503fc1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab00dbbd4d0d7c829374f726f66020bcc"><td class="memItemLeft" align="right" valign="top"><a id="ab00dbbd4d0d7c829374f726f66020bcc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>i2c_write</b> (unsigned char data)</td></tr>
<tr class="separator:ab00dbbd4d0d7c829374f726f66020bcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a669c0357614a79b3b35ae815f6f50e82"><td class="memItemLeft" align="right" valign="top"><a id="a669c0357614a79b3b35ae815f6f50e82"></a>
unsigned char&#160;</td><td class="memItemRight" valign="bottom"><b>i2c_read</b> (unsigned char ack)</td></tr>
<tr class="separator:a669c0357614a79b3b35ae815f6f50e82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa161ecc9fae4c6dbf5ef7063d777d1d"><td class="memItemLeft" align="right" valign="top"><a id="afa161ecc9fae4c6dbf5ef7063d777d1d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>loadESBData</b> (void)</td></tr>
<tr class="separator:afa161ecc9fae4c6dbf5ef7063d777d1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation for the functions relating to the communication of the ECU/ESB and ECU/Windows GUI. </p>
<dl class="section author"><dt>Author</dt><dd>Nick Moore  March 16, 2018 </dd></dl>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000001">Bug:</a></b></dt><dd>No known bugs. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Add notes here </dd></dl>

<p class="definition">Definition in file <a class="el" href="_communication_8c_source.html">Communication.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aa3590f927d6f0e270aad13cd890ba3d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3590f927d6f0e270aad13cd890ba3d5">&#9670;&nbsp;</a></span>ESB_Connect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ESB_Connect </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establishes the connection between the ECU and ESB. </p>
<p>This performs the following functions:</p>
<p>1) Prepares the ECU's password for transmission 2) Sends the password to the ESB 3) Awaits the correct return password from the ESB 4) repeats steps 2-4 until the proper return password is received</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="_communication_8c_source.html#l00053">53</a> of file <a class="el" href="_communication_8c_source.html">Communication.c</a>.</p>

<p class="reference">References <a class="el" href="_e_c_u__funcs_8h_source.html#l00159">ESBtransmit</a>, and <a class="el" href="_communication_8c_source.html#l00028">sendToESB()</a>.</p>
<div class="fragment"><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="_e_c_u__funcs_8h.html#a346573bf31cc5cb1e4a0d2d95029782a">ESBtransmit</a>[0] = <span class="charliteral">&#39;A&#39;</span>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="_e_c_u__funcs_8h.html#a346573bf31cc5cb1e4a0d2d95029782a">ESBtransmit</a>[1] = <span class="charliteral">&#39;C&#39;</span>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="_e_c_u__funcs_8h.html#a346573bf31cc5cb1e4a0d2d95029782a">ESBtransmit</a>[2] = <span class="charliteral">&#39;E&#39;</span>;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="_e_c_u__funcs_8h.html#a346573bf31cc5cb1e4a0d2d95029782a">ESBtransmit</a>[3] = <span class="charliteral">&#39;S&#39;</span>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="_communication_8c.html#a9ad78c90a2e828201a614444385801c7">sendToESB</a>(4);   </div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div><div class="ttc" id="_communication_8c_html_a9ad78c90a2e828201a614444385801c7"><div class="ttname"><a href="_communication_8c.html#a9ad78c90a2e828201a614444385801c7">sendToESB</a></div><div class="ttdeci">void sendToESB(uint8_t len)</div><div class="ttdoc">Transmits data between the ECU and ESB. </div><div class="ttdef"><b>Definition:</b> <a href="_communication_8c_source.html#l00028">Communication.c:28</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_a346573bf31cc5cb1e4a0d2d95029782a"><div class="ttname"><a href="_e_c_u__funcs_8h.html#a346573bf31cc5cb1e4a0d2d95029782a">ESBtransmit</a></div><div class="ttdeci">char ESBtransmit[11]</div><div class="ttdoc">Array of data which will be transmitted to the ESB. </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00159">ECU_funcs.h:159</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ada467eaa29152bd3a35afbf4d62e53fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada467eaa29152bd3a35afbf4d62e53fd">&#9670;&nbsp;</a></span>GUI_Connect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GUI_Connect </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Establishes the connection between the ECU and Windows GUI. </p>
<p>This performs the following functions:</p>
<p>1) Prepares the ECU's password for transmission 2) Sends the password to the Windows GUI</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="_communication_8c_source.html#l00073">73</a> of file <a class="el" href="_communication_8c_source.html">Communication.c</a>.</p>

<p class="reference">References <a class="el" href="_e_c_u__funcs_8h_source.html#l00156">connected_GUI</a>, and <a class="el" href="_e_c_u__funcs_8h_source.html#l00180">doTransmit</a>.</p>
<div class="fragment"><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;{</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordtype">char</span> message[] = <span class="stringliteral">&quot;DALE&quot;</span>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; 4; i++){                <span class="comment">// This will also send the terminator</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <span class="comment">/* Wait for empty transmit buffer */</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">while</span> ( !( UCSR0A &amp; (1&lt;&lt;UDRE0)) );</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="comment">/* Put data into buffer, sends the data */</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        UDR0 = message[i];</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    }</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="_e_c_u__funcs_8h.html#aaaa9e2d2909ceb75751c9dbfab30661c">connected_GUI</a> = 1;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="_e_c_u__funcs_8h.html#aa8cc3e0359b222fe83e4f0351414d5a4">doTransmit</a> = -1;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;}</div><div class="ttc" id="_e_c_u__funcs_8h_html_aa8cc3e0359b222fe83e4f0351414d5a4"><div class="ttname"><a href="_e_c_u__funcs_8h.html#aa8cc3e0359b222fe83e4f0351414d5a4">doTransmit</a></div><div class="ttdeci">int8_t doTransmit</div><div class="ttdoc">Flag which is used to synchronize when messages are allowed to be sent to the GUI. </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00180">ECU_funcs.h:180</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_aaaa9e2d2909ceb75751c9dbfab30661c"><div class="ttname"><a href="_e_c_u__funcs_8h.html#aaaa9e2d2909ceb75751c9dbfab30661c">connected_GUI</a></div><div class="ttdeci">uint8_t connected_GUI</div><div class="ttdoc">Essentially boolean describing if the ECU is connected to the GUI or not. </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00156">ECU_funcs.h:156</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a084f0a9cf05b1877bd8a71a90dae7ff8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a084f0a9cf05b1877bd8a71a90dae7ff8">&#9670;&nbsp;</a></span>ISR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR </td>
          <td>(</td>
          <td class="paramtype">USART0_RX_vect&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interrupt Service Routine for when a message has been received from the Windows GUI. </p>
<p>This performs the following functions:</p>
<p>1) Sets the newCommand variable based on which type of command is being received 2) Awaits the second a later bytes depending on which type of command is being received 3) If a received command deviated from the expected format, the command is asked to be repeated</p>
<p>commandMode = 0 handles all undefined behavior commandMode = 1 corresponds to the GUI ordering the ECU to do something (starting or stopping) commandMode = 2 corresponds to the GUI requesting that the throttle be changed to a specified value (in percent of max)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="_communication_8c_source.html#l00191">191</a> of file <a class="el" href="_communication_8c_source.html">Communication.c</a>.</p>

<p class="reference">References <a class="el" href="_e_c_u__funcs_8c_source.html#l00104">assign_bit()</a>, <a class="el" href="_e_c_u__funcs_8h_source.html#l00144">commandMode</a>, <a class="el" href="_e_c_u__funcs_8h_source.html#l00171">connect_count</a>, <a class="el" href="_e_c_u__funcs_8h_source.html#l00156">connected_GUI</a>, <a class="el" href="_communication_8c_source.html#l00073">GUI_Connect()</a>, <a class="el" href="_e_c_u__funcs_8h_source.html#l00150">hasInterrupted</a>, <a class="el" href="_e_c_u__funcs_8h_source.html#l00147">newCommand</a>, <a class="el" href="_communication_8c_source.html#l00349">repeatCommand()</a>, <a class="el" href="_communication_8c_source.html#l00096">sendToLaptop()</a>, <a class="el" href="_engine__funcs_8c_source.html#l00024">shutdown()</a>, <a class="el" href="_engine__funcs_8c_source.html#l00045">startup()</a>, <a class="el" href="_engine__funcs_8c_source.html#l00068">throttle()</a>, and <a class="el" href="_e_c_u__funcs_8h_source.html#l00120">throttle_per</a>.</p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;{</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// This will automatically clear the interrupt flag</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">char</span> data = UDR0;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="_e_c_u__funcs_8h.html#ac8b367a3ec51bcbf0a598e54edda7610">hasInterrupted</a> = 1;                    <span class="comment">// Set this flag so that the ESBCommand function knows if it has been interrupted or not</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_e_c_u__funcs_8h.html#a4a8bbdf0f587322d8d34a2d4b84ea8a6">newCommand</a>){</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <a class="code" href="_e_c_u__funcs_8h.html#a4a8bbdf0f587322d8d34a2d4b84ea8a6">newCommand</a> = 0;                    <span class="comment">// reset this so that the commandMode cannot change until the command string is done</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">if</span> (data == <span class="charliteral">&#39;A&#39;</span>){</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <a class="code" href="_e_c_u__funcs_8h.html#a04e4c743fe091014b2a959319bc508ef">connect_count</a> = 1;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <a class="code" href="_e_c_u__funcs_8h.html#a4a8bbdf0f587322d8d34a2d4b84ea8a6">newCommand</a> = 1;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (data == <span class="charliteral">&#39;C&#39;</span> &amp;&amp; <a class="code" href="_e_c_u__funcs_8h.html#a04e4c743fe091014b2a959319bc508ef">connect_count</a> == 1){</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <a class="code" href="_e_c_u__funcs_8h.html#a04e4c743fe091014b2a959319bc508ef">connect_count</a>++;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            <a class="code" href="_e_c_u__funcs_8h.html#a4a8bbdf0f587322d8d34a2d4b84ea8a6">newCommand</a> = 1;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (data == <span class="charliteral">&#39;E&#39;</span> &amp;&amp; <a class="code" href="_e_c_u__funcs_8h.html#a04e4c743fe091014b2a959319bc508ef">connect_count</a> == 2){</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            <a class="code" href="_e_c_u__funcs_8h.html#a04e4c743fe091014b2a959319bc508ef">connect_count</a>++;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <a class="code" href="_e_c_u__funcs_8h.html#a4a8bbdf0f587322d8d34a2d4b84ea8a6">newCommand</a> = 1;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (data == <span class="charliteral">&#39;S&#39;</span> &amp;&amp; <a class="code" href="_e_c_u__funcs_8h.html#a04e4c743fe091014b2a959319bc508ef">connect_count</a> == 3){</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            <a class="code" href="_e_c_u__funcs_8h.html#a04e4c743fe091014b2a959319bc508ef">connect_count</a>++;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <a class="code" href="_communication_8c.html#ada467eaa29152bd3a35afbf4d62e53fd">GUI_Connect</a>();</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <a class="code" href="_e_c_u__funcs_8h.html#a4a8bbdf0f587322d8d34a2d4b84ea8a6">newCommand</a> = 1;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        }</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (data == <span class="charliteral">&#39;O&#39;</span>){</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <a class="code" href="_e_c_u__funcs_8h.html#a543395e72464c9afc14f3766126d2d59">commandMode</a> = 1;               <span class="comment">// This means the GUI is ordering the ECU to do something</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (data == <span class="charliteral">&#39;T&#39;</span>){</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <a class="code" href="_e_c_u__funcs_8h.html#a543395e72464c9afc14f3766126d2d59">commandMode</a> = 2;               <span class="comment">// This means the GUI is requesting the ECU change the throttle to a specified value</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (data == <span class="charliteral">&#39;K&#39;</span>){             <span class="comment">// This means the GUI is sending a confirmation message for receiving the usual data transfer</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <a class="code" href="_e_c_u__funcs_8h.html#a4a8bbdf0f587322d8d34a2d4b84ea8a6">newCommand</a> = 1;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="comment">// stop timer 4</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            <a class="code" href="_e_c_u__funcs_8c.html#aba7fa75d6dd6ebcdc6225282a798fcd2">assign_bit</a>(&amp;TCCR4B, CS41, 0);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <a class="code" href="_e_c_u__funcs_8c.html#aba7fa75d6dd6ebcdc6225282a798fcd2">assign_bit</a>(&amp;TCCR4B, CS40, 0);            <span class="comment">// turn off the timer</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            TCNT4 = 40536;                           <span class="comment">// reset the timer register</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (data == <span class="charliteral">&#39;R&#39;</span>){    <span class="comment">// This means that the data needs to be sent to the GUI one more time</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <a class="code" href="_e_c_u__funcs_8h.html#a4a8bbdf0f587322d8d34a2d4b84ea8a6">newCommand</a> = 1;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            <a class="code" href="_communication_8c.html#aebc6f692b7c3787a859445b96ab3ec5f">sendToLaptop</a>();   <span class="comment">// this will just use what ever the values of the data currently are</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">else</span>{</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <a class="code" href="_e_c_u__funcs_8h.html#a543395e72464c9afc14f3766126d2d59">commandMode</a> = 0;               <span class="comment">// This will handle all undefined behavior</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="_e_c_u__funcs_8h.html#aaaa9e2d2909ceb75751c9dbfab30661c">connected_GUI</a>)</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                <a class="code" href="_e_c_u__funcs_8h.html#a4a8bbdf0f587322d8d34a2d4b84ea8a6">newCommand</a> = 1;     <span class="comment">// This was found to work during debugging as there is a 0 waiting in the buffer</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_e_c_u__funcs_8h.html#aaaa9e2d2909ceb75751c9dbfab30661c">connected_GUI</a>) {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="_e_c_u__funcs_8h.html#a4a8bbdf0f587322d8d34a2d4b84ea8a6">newCommand</a> = 1;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="_e_c_u__funcs_8h.html#a543395e72464c9afc14f3766126d2d59">commandMode</a>){</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <a class="code" href="_communication_8c.html#a285a2f8773a070acdcea234b60cf38ca">repeatCommand</a>();           <span class="comment">// repeat the command because something got screwed up  This isn&#39;t right because I don&#39;t do it over spi, do it over USART</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                <span class="keywordflow">if</span> (data == <span class="charliteral">&#39;S&#39;</span>){          <span class="comment">// GUI wants the engine to stop</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                    <a class="code" href="_e_c_u__funcs_8h.html#a1c9d5e29ad8899afe0c34571ddee18f9">shutdown</a>();</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                }</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (data == <span class="charliteral">&#39;r&#39;</span>){     <span class="comment">// GUI wants the engine to start</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    <a class="code" href="_e_c_u__funcs_8h.html#ab0c801cf89f8b3058ff2460c666154c3">startup</a>();</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <span class="keywordflow">else</span>{</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    <a class="code" href="_communication_8c.html#a285a2f8773a070acdcea234b60cf38ca">repeatCommand</a>();       <span class="comment">// undefined behavior, ask GUI to repeat</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <a class="code" href="_e_c_u__funcs_8h.html#a800e7967d4d08ade3357ea12c132dd46">throttle_per</a> = data;       <span class="comment">// GUI wants the throttle to the value specified by data</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <a class="code" href="_e_c_u__funcs_8h.html#a54163ad9d4f9e7fa08b4aae836a1b316">throttle</a>();</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <a class="code" href="_e_c_u__funcs_8h.html#a4a8bbdf0f587322d8d34a2d4b84ea8a6">newCommand</a> = 1;                    <span class="comment">// reset this so that a new command will be accepted in the way that is expected</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        </div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div><div class="ttc" id="_e_c_u__funcs_8h_html_ac8b367a3ec51bcbf0a598e54edda7610"><div class="ttname"><a href="_e_c_u__funcs_8h.html#ac8b367a3ec51bcbf0a598e54edda7610">hasInterrupted</a></div><div class="ttdeci">uint8_t hasInterrupted</div><div class="ttdoc">Will keep track of whether or not the message to the ESB has been interrupted by the PC...</div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00150">ECU_funcs.h:150</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_a800e7967d4d08ade3357ea12c132dd46"><div class="ttname"><a href="_e_c_u__funcs_8h.html#a800e7967d4d08ade3357ea12c132dd46">throttle_per</a></div><div class="ttdeci">uint8_t throttle_per</div><div class="ttdoc">Char which keeps track of the throttle percentage 0-100. </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00120">ECU_funcs.h:120</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_a04e4c743fe091014b2a959319bc508ef"><div class="ttname"><a href="_e_c_u__funcs_8h.html#a04e4c743fe091014b2a959319bc508ef">connect_count</a></div><div class="ttdeci">uint8_t connect_count</div><div class="ttdoc">Counter for index into the connection string (The connection string is ACES) </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00171">ECU_funcs.h:171</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8c_html_aba7fa75d6dd6ebcdc6225282a798fcd2"><div class="ttname"><a href="_e_c_u__funcs_8c.html#aba7fa75d6dd6ebcdc6225282a798fcd2">assign_bit</a></div><div class="ttdeci">void assign_bit(volatile uint8_t *sfr, uint8_t bit, uint8_t val)</div><div class="ttdoc">Sets the specified bit to the specified value or does nothing if it already set to that...</div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8c_source.html#l00104">ECU_funcs.c:104</a></div></div>
<div class="ttc" id="_communication_8c_html_aebc6f692b7c3787a859445b96ab3ec5f"><div class="ttname"><a href="_communication_8c.html#aebc6f692b7c3787a859445b96ab3ec5f">sendToLaptop</a></div><div class="ttdeci">void sendToLaptop(void)</div><div class="ttdoc">Transmits periodic data between the ECU and Windows GUI. </div><div class="ttdef"><b>Definition:</b> <a href="_communication_8c_source.html#l00096">Communication.c:96</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_ab0c801cf89f8b3058ff2460c666154c3"><div class="ttname"><a href="_e_c_u__funcs_8h.html#ab0c801cf89f8b3058ff2460c666154c3">startup</a></div><div class="ttdeci">void startup(void)</div><div class="ttdoc">Commands the ESB to startup and awaits the confirmation code. </div><div class="ttdef"><b>Definition:</b> <a href="_engine__funcs_8c_source.html#l00045">Engine_funcs.c:45</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_a54163ad9d4f9e7fa08b4aae836a1b316"><div class="ttname"><a href="_e_c_u__funcs_8h.html#a54163ad9d4f9e7fa08b4aae836a1b316">throttle</a></div><div class="ttdeci">void throttle(void)</div><div class="ttdoc">Commands the ESB to adjust the throttle and awaits the confirmation code. </div><div class="ttdef"><b>Definition:</b> <a href="_engine__funcs_8c_source.html#l00068">Engine_funcs.c:68</a></div></div>
<div class="ttc" id="_communication_8c_html_ada467eaa29152bd3a35afbf4d62e53fd"><div class="ttname"><a href="_communication_8c.html#ada467eaa29152bd3a35afbf4d62e53fd">GUI_Connect</a></div><div class="ttdeci">void GUI_Connect(void)</div><div class="ttdoc">Establishes the connection between the ECU and Windows GUI. </div><div class="ttdef"><b>Definition:</b> <a href="_communication_8c_source.html#l00073">Communication.c:73</a></div></div>
<div class="ttc" id="_communication_8c_html_a285a2f8773a070acdcea234b60cf38ca"><div class="ttname"><a href="_communication_8c.html#a285a2f8773a070acdcea234b60cf38ca">repeatCommand</a></div><div class="ttdeci">void repeatCommand(void)</div><div class="ttdoc">Requests the Windows GUI to repeat the last sent command. </div><div class="ttdef"><b>Definition:</b> <a href="_communication_8c_source.html#l00349">Communication.c:349</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_a4a8bbdf0f587322d8d34a2d4b84ea8a6"><div class="ttname"><a href="_e_c_u__funcs_8h.html#a4a8bbdf0f587322d8d34a2d4b84ea8a6">newCommand</a></div><div class="ttdeci">uint8_t newCommand</div><div class="ttdoc">Will keep track of whether or not it is possible for a new command stream to be coming in...</div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00147">ECU_funcs.h:147</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_a1c9d5e29ad8899afe0c34571ddee18f9"><div class="ttname"><a href="_e_c_u__funcs_8h.html#a1c9d5e29ad8899afe0c34571ddee18f9">shutdown</a></div><div class="ttdeci">void shutdown(void)</div><div class="ttdoc">Commands the ESB to shutdown and awaits the confirmation code. </div><div class="ttdef"><b>Definition:</b> <a href="_engine__funcs_8c_source.html#l00024">Engine_funcs.c:24</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_aaaa9e2d2909ceb75751c9dbfab30661c"><div class="ttname"><a href="_e_c_u__funcs_8h.html#aaaa9e2d2909ceb75751c9dbfab30661c">connected_GUI</a></div><div class="ttdeci">uint8_t connected_GUI</div><div class="ttdoc">Essentially boolean describing if the ECU is connected to the GUI or not. </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00156">ECU_funcs.h:156</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_a543395e72464c9afc14f3766126d2d59"><div class="ttname"><a href="_e_c_u__funcs_8h.html#a543395e72464c9afc14f3766126d2d59">commandMode</a></div><div class="ttdeci">uint8_t commandMode</div><div class="ttdoc">Will keep track of the input format that the ECU will be expecting. </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00144">ECU_funcs.h:144</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a285a2f8773a070acdcea234b60cf38ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a285a2f8773a070acdcea234b60cf38ca">&#9670;&nbsp;</a></span>repeatCommand()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void repeatCommand </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Requests the Windows GUI to repeat the last sent command. </p>
<p>This performs the following functions:</p>
<p>1) Sends the char to the GUI which signals a command repetition is required</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="_communication_8c_source.html#l00349">349</a> of file <a class="el" href="_communication_8c_source.html">Communication.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;{</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">/* Wait for empty transmit buffer */</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">while</span> ( !( UCSR0A &amp; (1&lt;&lt;UDRE0)) );</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    </div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">/* Put data into buffer, sends the data */</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    UDR0 = <span class="charliteral">&#39;V&#39;</span>; </div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// Will have to see in unit testing how long this takes to get the response from the GUI</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div></div><!-- fragment -->
</div>
</div>
<a id="a9ad78c90a2e828201a614444385801c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ad78c90a2e828201a614444385801c7">&#9670;&nbsp;</a></span>sendToESB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sendToESB </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>len</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmits data between the ECU and ESB. </p>
<p>This performs the following functions:</p>
<p>1) Pulls the SS line for the ESB low, this will cause the ESB to listen to the com line 2) Fills the specified data into the transmit buffer 3) Waits for the data to be received from the ESB 4) Pulls the SS line high to end communication with ESB for that byte</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">char</td><td>The byte that is going to be sent to the ESB </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>char The received byte from the ESB </dd></dl>

<p class="definition">Definition at line <a class="el" href="_communication_8c_source.html#l00028">28</a> of file <a class="el" href="_communication_8c_source.html">Communication.c</a>.</p>

<p class="reference">References <a class="el" href="_e_c_u__funcs_8h_source.html#l00159">ESBtransmit</a>.</p>
<div class="fragment"><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">// this will send the number of character in ESBmessage up to len</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    cli();</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordflow">for</span>(uint8_t i = 0; i &lt; len; i++)</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    {</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        <span class="keywordflow">while</span> ( !( UCSR1A &amp; (1&lt;&lt;UDRE1)) );</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        <span class="comment">/* Put data into buffer, sends the data */</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        UDR1 = <a class="code" href="_e_c_u__funcs_8h.html#a346573bf31cc5cb1e4a0d2d95029782a">ESBtransmit</a>[i];</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    }</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    sei();</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;}</div><div class="ttc" id="_e_c_u__funcs_8h_html_a346573bf31cc5cb1e4a0d2d95029782a"><div class="ttname"><a href="_e_c_u__funcs_8h.html#a346573bf31cc5cb1e4a0d2d95029782a">ESBtransmit</a></div><div class="ttdeci">char ESBtransmit[11]</div><div class="ttdoc">Array of data which will be transmitted to the ESB. </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00159">ECU_funcs.h:159</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aebc6f692b7c3787a859445b96ab3ec5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebc6f692b7c3787a859445b96ab3ec5f">&#9670;&nbsp;</a></span>sendToLaptop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sendToLaptop </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmits periodic data between the ECU and Windows GUI. </p>
<p>This performs the following functions:</p>
<p>1) Prepares the message to send to the Windows GUI 2) Loops through this message, sending it one byte at a time</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">void</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

<p class="definition">Definition at line <a class="el" href="_communication_8c_source.html#l00096">96</a> of file <a class="el" href="_communication_8c_source.html">Communication.c</a>.</p>

<p class="reference">References <a class="el" href="_e_c_u__funcs_8c_source.html#l00196">calculateParity()</a>, <a class="el" href="_e_c_u__funcs_8h_source.html#l00153">connected_ESB</a>, <a class="el" href="_e_c_u__funcs_8h_source.html#l00165">ECU_temp</a>, <a class="el" href="_e_c_u__funcs_8h_source.html#l00132">EGT</a>, <a class="el" href="_e_c_u__funcs_8h_source.html#l00168">ESB_temp</a>, <a class="el" href="_e_c_u__funcs_8h_source.html#l00135">glow_plug</a>, <a class="el" href="_e_c_u__funcs_8h_source.html#l00129">Hall_effect</a>, <a class="el" href="_e_c_u__funcs_8h.html#a411b8ca204ac2d44a3755adcf4477c92">massFlow</a>, <a class="el" href="_e_c_u__funcs_8h_source.html#l00117">opMode</a>, and <a class="el" href="_e_c_u__funcs_8h.html#ad849b9fe0e266552696acb467ff745f7">voltage</a>.</p>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;{</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">//loadESBData();</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    dummyData();    <span class="comment">// remove this later</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// This function will be responsible for packaging and sending the desired data to the Windows GUI</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordtype">char</span> message[28];              <span class="comment">// this is the base length of the message with room for the parity bytes</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// now fill the message</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="_e_c_u__funcs_8h.html#a20d5783317799eb3e211c4cae2516cec">connected_ESB</a>){</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        message[0] = <span class="charliteral">&#39;b&#39;</span>;          <span class="comment">// This means that the ESB is not connected or it has lost connection</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_e_c_u__funcs_8h.html#ab1fa4bbd357586cbfa309f1b8614c1ae">opMode</a> == 0){</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        message[0] = <span class="charliteral">&#39;S&#39;</span>;          <span class="comment">// This means that an engine shutdown is being carried out</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="_e_c_u__funcs_8h.html#ab1fa4bbd357586cbfa309f1b8614c1ae">opMode</a> == 1){</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        message[0] = <span class="charliteral">&#39;r&#39;</span>;          <span class="comment">// This means that an engine startup is in progress</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="_e_c_u__funcs_8h.html#ab1fa4bbd357586cbfa309f1b8614c1ae">opMode</a> == 2){</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        message[0] = <span class="charliteral">&#39;t&#39;</span>;          <span class="comment">// This means that a throttle adjustment has been requested and is being carried out</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="_e_c_u__funcs_8h.html#ab1fa4bbd357586cbfa309f1b8614c1ae">opMode</a> == 4){</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        message[0] = <span class="charliteral">&#39;C&#39;</span>;          <span class="comment">// This means that the engine is in the cooling mode</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="_e_c_u__funcs_8h.html#ab1fa4bbd357586cbfa309f1b8614c1ae">opMode</a> == 5){</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        message[0] = <span class="charliteral">&#39;n&#39;</span>;          <span class="comment">// The engine is not doing anything</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_e_c_u__funcs_8h.html#ab1fa4bbd357586cbfa309f1b8614c1ae">opMode</a> == 6){</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        message[0] = <span class="charliteral">&#39;g&#39;</span>;          <span class="comment">// Special shutdown, the EGT is not working properly and there cannot be a normal cooling mode</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_e_c_u__funcs_8h.html#ab1fa4bbd357586cbfa309f1b8614c1ae">opMode</a> == 7){</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        message[0] = <span class="charliteral">&#39;N&#39;</span>;          <span class="comment">// This means that the engine has reached the desired throttle, within the error tolerance</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_e_c_u__funcs_8h.html#ab1fa4bbd357586cbfa309f1b8614c1ae">opMode</a> == 9){         <span class="comment">// This means that fuel is not flowing when it should be flowing</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        message[0] = <span class="charliteral">&#39;P&#39;</span>;   </div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_e_c_u__funcs_8h.html#ab1fa4bbd357586cbfa309f1b8614c1ae">opMode</a> == 10){</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        message[0] = <span class="charliteral">&#39;I&#39;</span>;          <span class="comment">// This means that the engine has reached idle</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_e_c_u__funcs_8h.html#ab1fa4bbd357586cbfa309f1b8614c1ae">opMode</a> == 11){</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        message[0] = <span class="charliteral">&#39;c&#39;</span>;          <span class="comment">// This means that messages from the ECU have failed the parity check</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_e_c_u__funcs_8h.html#ab1fa4bbd357586cbfa309f1b8614c1ae">opMode</a> == 12){</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        message[0] = <span class="charliteral">&#39;R&#39;</span>;          <span class="comment">// This means that RPM limit has been reached and the engine is shutting down</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_e_c_u__funcs_8h.html#ab1fa4bbd357586cbfa309f1b8614c1ae">opMode</a> == 13){</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        message[0] = <span class="charliteral">&#39;T&#39;</span>;          <span class="comment">// This means the Temperature limit has been reached and the engine is shutting down</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="_e_c_u__funcs_8h.html#ab1fa4bbd357586cbfa309f1b8614c1ae">opMode</a> == 14){</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        message[0] = <span class="charliteral">&#39;s&#39;</span>;          <span class="comment">// This means that messages from the ESB have failed the parity check</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        </div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    memcpy(message+1,&amp;<a class="code" href="_e_c_u__funcs_8h.html#a411b8ca204ac2d44a3755adcf4477c92">massFlow</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));          <span class="comment">// This should fill 1-&gt;4 with the float value</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    memcpy(message+5,&amp;<a class="code" href="_e_c_u__funcs_8h.html#afc4ac50caf210854dacff228ba315687">Hall_effect</a>,<span class="keyword">sizeof</span>(uint16_t));    <span class="comment">// This should fill 5-&gt;6 with the Hall effect sensor value</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    memcpy(message+7,&amp;<a class="code" href="_e_c_u__funcs_8h.html#a34c104e39ff60265f33e3325bf865ab5">EGT</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));            <span class="comment">// This should fill 7-&gt;8 with the EGT value </span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    memcpy(message+11,&amp;<a class="code" href="_e_c_u__funcs_8h.html#ad849b9fe0e266552696acb467ff745f7">voltage</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));      <span class="comment">// this should fill 9-&gt;12 with the value of the battery voltage</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    memcpy(message+15,&amp;<a class="code" href="_e_c_u__funcs_8h.html#a17961c0bba1aa12ef80b5b9b78726530">glow_plug</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));         <span class="comment">// This should fill 13 with the glow plug on/off</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    memcpy(message+16,&amp;<a class="code" href="_e_c_u__funcs_8h.html#ad0434de2efd3a26ea1211a9cec967577">ECU_temp</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));         <span class="comment">// This should fill 14-&gt;17 with the temperature of the ECU</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    memcpy(message+20,&amp;<a class="code" href="_e_c_u__funcs_8h.html#a359dd774222ff15507f3efb2d0e89bbe">ESB_temp</a>,<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));         <span class="comment">// This should fill 18-&gt;21 with the ambient temperature of the ESB</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    </div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// now that the message is made, I need to calculate and populate the parity bytes</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    message[24] = <a class="code" href="_e_c_u__funcs_8c.html#adc85b180d655324bb96dcb29cff05af3">calculateParity</a>(message, 0);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    message[25] = <a class="code" href="_e_c_u__funcs_8c.html#adc85b180d655324bb96dcb29cff05af3">calculateParity</a>(message, 6);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    message[26] = <a class="code" href="_e_c_u__funcs_8c.html#adc85b180d655324bb96dcb29cff05af3">calculateParity</a>(message, 12);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    message[27] = <a class="code" href="_e_c_u__funcs_8c.html#adc85b180d655324bb96dcb29cff05af3">calculateParity</a>(message, 18);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    </div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// At this point it is advantageous to turn off global interrupts so that this process is not interrupted</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    cli();</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; 28; i++){</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="comment">/* Wait for empty transmit buffer */</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">while</span> ( !( UCSR0A &amp; (1&lt;&lt;UDRE0)) );</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="comment">/* Put data into buffer, sends the data */</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        UDR0 = message[i];</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    sei();   <span class="comment">// Now need to turn global interrupts back on</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// Now start the timer</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    </div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    TCCR4B = (1 &lt;&lt; CS42);      <span class="comment">// start timer 4 with prescalar of 256</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;}</div><div class="ttc" id="_e_c_u__funcs_8h_html_a17961c0bba1aa12ef80b5b9b78726530"><div class="ttname"><a href="_e_c_u__funcs_8h.html#a17961c0bba1aa12ef80b5b9b78726530">glow_plug</a></div><div class="ttdeci">unsigned char glow_plug</div><div class="ttdoc">unsigned char holding whether or not the glow plug is currently on </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00135">ECU_funcs.h:135</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_a20d5783317799eb3e211c4cae2516cec"><div class="ttname"><a href="_e_c_u__funcs_8h.html#a20d5783317799eb3e211c4cae2516cec">connected_ESB</a></div><div class="ttdeci">uint8_t connected_ESB</div><div class="ttdoc">Will keep track of whether or not the ECU is connected to the windows GUI. </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00153">ECU_funcs.h:153</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_a359dd774222ff15507f3efb2d0e89bbe"><div class="ttname"><a href="_e_c_u__funcs_8h.html#a359dd774222ff15507f3efb2d0e89bbe">ESB_temp</a></div><div class="ttdeci">float ESB_temp</div><div class="ttdoc">Ambient temperature of the ESB. </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00168">ECU_funcs.h:168</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8c_html_adc85b180d655324bb96dcb29cff05af3"><div class="ttname"><a href="_e_c_u__funcs_8c.html#adc85b180d655324bb96dcb29cff05af3">calculateParity</a></div><div class="ttdeci">char calculateParity(char message[], uint8_t start_index)</div><div class="ttdoc">Function to calculate the parity byte for a corresponding sequence of 6 bytes. </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8c_source.html#l00196">ECU_funcs.c:196</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_afc4ac50caf210854dacff228ba315687"><div class="ttname"><a href="_e_c_u__funcs_8h.html#afc4ac50caf210854dacff228ba315687">Hall_effect</a></div><div class="ttdeci">uint16_t Hall_effect</div><div class="ttdoc">uint_16 holding the current measurement of the hall effect sensor </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00129">ECU_funcs.h:129</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_ab1fa4bbd357586cbfa309f1b8614c1ae"><div class="ttname"><a href="_e_c_u__funcs_8h.html#ab1fa4bbd357586cbfa309f1b8614c1ae">opMode</a></div><div class="ttdeci">char opMode</div><div class="ttdoc">Holds the current operational mode of the engine. </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00117">ECU_funcs.h:117</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_a411b8ca204ac2d44a3755adcf4477c92"><div class="ttname"><a href="_e_c_u__funcs_8h.html#a411b8ca204ac2d44a3755adcf4477c92">massFlow</a></div><div class="ttdeci">union @1 massFlow</div><div class="ttdoc">Float holding the current mass flow rate. </div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_a34c104e39ff60265f33e3325bf865ab5"><div class="ttname"><a href="_e_c_u__funcs_8h.html#a34c104e39ff60265f33e3325bf865ab5">EGT</a></div><div class="ttdeci">float EGT</div><div class="ttdoc">uint_16 holding the current measurement of the exhaust gas thermocouple </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00132">ECU_funcs.h:132</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_ad0434de2efd3a26ea1211a9cec967577"><div class="ttname"><a href="_e_c_u__funcs_8h.html#ad0434de2efd3a26ea1211a9cec967577">ECU_temp</a></div><div class="ttdeci">float ECU_temp</div><div class="ttdoc">Ambient temperature of the ECU. </div><div class="ttdef"><b>Definition:</b> <a href="_e_c_u__funcs_8h_source.html#l00165">ECU_funcs.h:165</a></div></div>
<div class="ttc" id="_e_c_u__funcs_8h_html_ad849b9fe0e266552696acb467ff745f7"><div class="ttname"><a href="_e_c_u__funcs_8h.html#ad849b9fe0e266552696acb467ff745f7">voltage</a></div><div class="ttdeci">union @0 voltage</div><div class="ttdoc">Float which contains the current voltage level on the Lipo battery. </div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
